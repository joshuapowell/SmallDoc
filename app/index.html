<!DOCTYPE html>

<html manifest="smalldoc.manifest">

	<head>
        <meta charset="utf-8">
        <meta name="description" content="Simple note taking for your browser or mobile device">
        
	    <meta name="viewport" content="user-scalable=no, width=device-width, initial-scale=1.0, maximum-scale=1.0"/>
	    <meta name="apple-mobile-web-app-capable" content="yes" />
	
	    <meta name="apple-mobile-web-app-status-bar-style" content="black" />

        <title>SmallDoc</title>

		<!-- CSS -->
		<link rel="apple-touch-startup-image" href="img/bgStartup.png" />
	    <link rel="apple-touch-icon" href="img/appIcon.png"/>

		<link rel="stylesheet" href="css/global.css?qskerjf" />
		<link rel="stylesheet" href="css/index.css?qskerjf" />

		<!-- jQuery, Prototype & JavaScript -->
		<script src="http://code.jquery.com/jquery-1.5.2.min.js"></script>
		<script type="text/javascript">
	
			$(document).ready(function() {
				
				if (!localStorage.getItem('docFileCount')) {
					$("#page-list #first-time").show();
				}
			
				for (i = 1; i <= localStorage.getItem('docFileCount'); i++) {

					if (localStorage.getItem("doc" + i + "_title") != '' && localStorage.getItem("doc" + i + "_title") != 0) {
						$("#page-list ul").append('<li><a id="item_' + i + '" href="#">' + localStorage.getItem("doc" + i + "_title") + '</a></li>');
					}

				}
			
				function loadDocData(id) {
					
					$("#existing").val(id);
					$("#title").val(localStorage.getItem("doc" + id + "_title"));
					$("#content").val(localStorage.getItem("doc" + id + "_content"));

				}

				$("#submit").click(function() {
					
					if ($("#existing").val()) {

						var id = $("#existing").val();
	
					} else {

						var submitCount = localStorage.getItem('docFileCount');
						var id = Number(submitCount) + 1;

						localStorage.setItem('docFileCount', id);
					}

						localStorage.setItem("doc" + id + "_title", $("#title").val());
						localStorage.setItem("doc" + id + "_content", $("#content").val());
										
				});
				
				$("#page-list ul li a").click(function () {
					var id = $(this).attr("id").replace("item_","");
					
					$("#page-list, #page-edit, #button-add").toggle();
					loadDocData(id);
				});
				
				$("#button-add, #button-add-first").click(function() {
					$("#page-list, #page-edit, #button-add").toggle();
					$("#content, #title").val("");
				});
				
				$("#cancel").click(function() {
					$("#page-list, #page-edit, #button-add").toggle();
				});

			});
 
 		</script>

	</head>
	<body>

		<header>
			<a class="button" href="#" title="Cancel changes">Cancel</a>
			<h1>SmallDoc</h1>
			<a class="button" href="#" title="Save this document">Save</a>
		</header>
		
		<section id="page-list">
			<ul>
			</ul>
			<p id="first-time" class="hide"><a href="#" id="button-add-first"><span>+</span><br />Create your first note</a></p>
		</section>

		<section id="page-edit">
			<form action="/" accept-charset="UTF-8" method="post" id="com-smalldoc">
				<p>
					<label for="title" class="hide">Title:</label>
					<input type="text" name="title" id="title" />
				</p>
				
				<p>
					<label for="content" class="hide">Content:</label>
					<textarea rows="10" name="content" id="content"></textarea>
				</p>
	
				<input type="hidden" id="existing" value="" />
				<input type="submit" id="submit" value="Save" />
				<input type="button" id="cancel" value="Cancel" />
			</form>
		</section>
	
		<footer>
			<a id="button-add" href="#" title="Add a new document">+</a>
		</footer>

	</body>
</html>
